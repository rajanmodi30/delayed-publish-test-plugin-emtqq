1. Add test cases for delayed publish
2. A new implementation for delayed publish
